# 자바스크립트에서 비동기 처리 다루기

자바스크립트의 동기적 처리와 비동기 처리에 대해 알아보자

- 동기적 처리: 작업이 순서대로 진행되고 다음 작업은 앞의 작업이 끝날 때까지 중지 상태가 되어 다른 작업을 할 수 없음
- 비동기 처리: 동시에 여러 작업을 처리할 수 있고 기다리는 과정에서 다른 함수 호출 가능
- 코드를 보고 이해해보자!
- 연산량이 많은 작업을 처리하는 함수

  ```js
  function work() {
    const start = Date.now();
    for (let i = 0; i < 1000000000; i++) {}
    const end = Date.now();
    console.log(end - start + "ms");
  }

  work();
  console.log("다음 작업");
  /*
  517ms
  다음 작업
  */
  ```

  - work()함수가 호출되면 for문이 돌아갈 때 다른 작업은 처리하지 않고 온전히 for문만 실행

- 만약 이 작업이 진행되는 동안 다른 작업도 하고 싶다면 함수를 비동기 형태로 전환해야 함

  - `setTimeout`이라는 함수 사용

  ```js
  function work() {
    setTimeouut(() => {
      const start = Date.now();
      for (let i = 0; i < 1000000000; i++) {}
      const end = Date.now();
      console.log(end - start + "ms");
    }, 0);
  }

  console.log("작업 시작!");
  work();
  console.log("다음 작업");
  /*
  작업 시작!
  다음 작업
  508ms
  */
  ```

  - `setTimeout`함수는 첫번째 파라미터에 넣은 함수를 두번째 파라미터에 넣은 시간(ms단위)이 흐른 후 호출해주는 함수
  - 지금은 두번째 파라미터에 0을 넣어서 바로 실행하라는 의미
    - 하지만 실제로는 4ms이후에 실행(브라우저의 최소값이기 때문)
  - 함수를 처리하는 동안 console.log("다음 작업"); 이 수행됨

- 이렇게 `setTimeout`을 사용하면 우리가 정한 함수가 백그라운드에서 수행되기 때문에 기존의 코드 흐름을 막지 않고 동시에 다른 작업들을 진행 가능

- 그렇다면, 만약 work함수가 끝난 다음에 작업을 처리하고 싶다면?

  - 콜백 함수를 파라미터로 전달해주면 됨!
  - 콜백 함수란 함수 타입의 값을 파라미터로 넘겨줘서 파라미터로 받은 함수를 특정 작업이 끝나고 호출해주는 것

  ```js
  function work(callback) {
    setTimeout(() => {
      const start = Date.now();
      for (let i = 0; i < 1000000000; i++) {}
      const end = Date.now();
      console.log(end - start + "ms");
      callback();
    }, 0);
  }

  console.log("작업 시작!");
  work(() => {
    console.log("작업이 끝났어요!");
  });
  console.log("다음 작업");
  /*
  작업 시작!
  다음 작업
  498ms
  작업이 끝났어요!
  */
  ```

- 비동기적으로 처리하는 작업

  - **Ajax Web API 요청**: 만약 서버쪽에서 데이터를 받아와야 할 때는, 요청을 하고 서버에서 응답을 할 때까지 대기해야하기 때문에 작업을 비동기적으로 처리
  - **파일 읽기**: 주로 서버 쪽에서 파일을 읽어야 하는 상황에는 비동기적으로 처리
  - **암호화/복호화**: 암호화/복호화를 할 때에도 바로 처리가 되지 않고, 시간이 어느정도 걸리는 경우가 있기 때문에 비동기적으로 처리
  - **작업 예약**: 단순히 어떤 작업을 몇 초 후에 스케쥴링 해야 하는 상황에는, setTimeout을 사용하여 비동기적으로 처리

- 비동기 작업을 다룰 때에는 callback함수 외에도 Promise, 그리고 async/await 라는 문법을 사용하여 처리 가능
